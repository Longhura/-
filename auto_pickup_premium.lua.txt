--[[
    AUTO PICKUP + FIX ALL GAME (PREMIUM VERSION)
    By ChatGPT | Mobile + PC
    âœ“ Nháº·t All 360Â° | âœ“ QuÃ©t Danh SÃ¡ch | âœ“ KhÃ³a Váº­t ThÃ´ng Minh
    âœ“ Xem Danh SÃ¡ch KhÃ³a | âœ“ Highlights XuyÃªn TÆ°á»ng | âœ“ Äá»‹nh Vá»‹ Váº­t Giá»‘ng
]]

-- ================= SERVICES =================
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local LP = Players.LocalPlayer
local Char, HRP, Cam

-- ================= SETTINGS =================
local enabled = false
local frontOnly = true
local range = 12
local delayTime = 0.25
-- Fixed blacklist system with proper tracking
local blacklistAll = {} -- {name_type = true} for "lock all similar"
local blacklistSolo = {} -- {obj_instance = true} for single object skip
local highlightedObjects = {}
local locateHighlights = {}

-- ================= LOAD CHARACTER =================
local function loadChar()
	Char = LP.Character or LP.CharacterAdded:Wait()
	HRP = Char:WaitForChild("HumanoidRootPart")
	Cam = workspace.CurrentCamera
end
loadChar()
LP.CharacterAdded:Connect(function()
	loadChar()
	highlightedObjects = {}
	for _, h in ipairs(highlightedObjects) do
		if h and h.Parent then h:Destroy() end
	end
	highlightedObjects = {}
end)

-- ================= UI SETUP =================
local gui = Instance.new("ScreenGui", game.CoreGui)
gui.Name = "AutoPickup_Premium"
gui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- ================= MAIN BUTTON =================
local icon = Instance.new("TextButton", gui)
icon.Size = UDim2.new(0, 60, 0, 60)
icon.Position = UDim2.new(0, 20, 0, 200)
icon.Text = "âš™"
icon.Font = Enum.Font.GothamBold
icon.TextSize = 28
icon.BackgroundColor3 = Color3.fromRGB(0, 150, 136)
icon.TextColor3 = Color3.new(1, 1, 1)
icon.Active, icon.Draggable = true, true
icon.BorderSizePixel = 0

local corner = Instance.new("UICorner", icon)
corner.CornerRadius = UDim.new(0, 12)

-- ================= MAIN MENU =================
local menu = Instance.new("Frame", gui)
menu.Size = UDim2.new(0, 280, 0, 700)
menu.Position = UDim2.new(0, 90, 0, 200)
menu.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
menu.Visible = false
menu.Active, menu.Draggable = true, true
menu.BorderSizePixel = 0

local menuCorner = Instance.new("UICorner", menu)
menuCorner.CornerRadius = UDim.new(0, 15)

local menuStroke = Instance.new("UIStroke", menu)
menuStroke.Color = Color3.fromRGB(0, 150, 136)
menuStroke.Thickness = 2

-- ================= SCAN WINDOW =================
local scanWindow = Instance.new("Frame", gui)
scanWindow.Size = UDim2.new(0, 450, 0, 550)
scanWindow.Position = UDim2.new(0, 400, 0, 200)
scanWindow.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
scanWindow.Visible = false
scanWindow.Active, scanWindow.Draggable = true, true
scanWindow.BorderSizePixel = 0

local scanCorner = Instance.new("UICorner", scanWindow)
scanCorner.CornerRadius = UDim.new(0, 15)

local scanStroke = Instance.new("UIStroke", scanWindow)
scanStroke.Color = Color3.fromRGB(76, 175, 80)
scanStroke.Thickness = 2

local scanTitle = Instance.new("TextLabel", scanWindow)
scanTitle.Size = UDim2.new(0, 420, 0, 30)
scanTitle.Position = UDim2.new(0, 15, 0, 8)
scanTitle.Text = "DANH SÃCH Váº¬T TÆ¯Æ NG TÃC"
scanTitle.Font = Enum.Font.GothamBold
scanTitle.TextSize = 14
scanTitle.BackgroundTransparency = 1
scanTitle.TextColor3 = Color3.fromRGB(76, 175, 80)

-- ================= BLACKLIST WINDOW =================
local blacklistWindow = Instance.new("Frame", gui)
blacklistWindow.Size = UDim2.new(0, 450, 0, 550)
blacklistWindow.Position = UDim2.new(0, 900, 0, 200)
blacklistWindow.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
blacklistWindow.Visible = false
blacklistWindow.Active, blacklistWindow.Draggable = true, true
blacklistWindow.BorderSizePixel = 0

local blacklistCorner = Instance.new("UICorner", blacklistWindow)
blacklistCorner.CornerRadius = UDim.new(0, 15)

local blacklistStroke = Instance.new("UIStroke", blacklistWindow)
blacklistStroke.Color = Color3.fromRGB(200, 50, 50)
blacklistStroke.Thickness = 2

local blacklistTitle = Instance.new("TextLabel", blacklistWindow)
blacklistTitle.Size = UDim2.new(0, 420, 0, 30)
blacklistTitle.Position = UDim2.new(0, 15, 0, 8)
blacklistTitle.Text = "DANH SÃCH KHÃ“A"
blacklistTitle.Font = Enum.Font.GothamBold
blacklistTitle.TextSize = 14
blacklistTitle.BackgroundTransparency = 1
blacklistTitle.TextColor3 = Color3.fromRGB(200, 50, 50)

-- ================= BLACKLIST LIST =================
local blacklistList = Instance.new("ScrollingFrame", blacklistWindow)
blacklistList.Size = UDim2.new(0, 420, 0, 490)
blacklistList.Position = UDim2.new(0, 15, 0, 50)
blacklistList.BackgroundTransparency = 1
blacklistList.ScrollBarThickness = 6
blacklistList.CanvasSize = UDim2.new(0, 0, 0, 0)
blacklistList.BorderSizePixel = 0

-- ================= SCAN LIST =================
local scanList = Instance.new("ScrollingFrame", scanWindow)
scanList.Size = UDim2.new(0, 420, 0, 490)
scanList.Position = UDim2.new(0, 15, 0, 50)
scanList.BackgroundTransparency = 1
scanList.ScrollBarThickness = 6
scanList.CanvasSize = UDim2.new(0, 0, 0, 0)
scanList.BorderSizePixel = 0

-- ================= UI HELPER FUNCTION =================
local function newBtn(text, y, parent, color)
	color = color or Color3.fromRGB(50, 50, 55)
	local b = Instance.new("TextButton", parent)
	b.Size = UDim2.new(0, 250, 0, 32)
	b.Position = UDim2.new(0, 15, 0, y)
	b.Text = text
	b.Font = Enum.Font.Gotham
	b.TextSize = 12
	b.BackgroundColor3 = color
	b.TextColor3 = Color3.new(1, 1, 1)
	b.BorderSizePixel = 0
	
	local btnCorner = Instance.new("UICorner", b)
	btnCorner.CornerRadius = UDim.new(0, 8)
	
	return b
end

local function newLabel(text, y, parent)
	local l = Instance.new("TextLabel", parent)
	l.Size = UDim2.new(0, 250, 0, 24)
	l.Position = UDim2.new(0, 15, 0, y)
	l.Text = text
	l.Font = Enum.Font.GothamBold
	l.TextSize = 13
	l.BackgroundTransparency = 1
	l.TextColor3 = Color3.fromRGB(200, 200, 200)
	return l
end

-- ================= MENU TOGGLE =================
icon.MouseButton1Click:Connect(function()
	menu.Visible = not menu.Visible
	scanWindow.Visible = false
	blacklistWindow.Visible = false
end)

-- ================= TITLE =================
newLabel("AUTO PICKUP - PREMIUM", 10, menu)

-- ================= AUTO PICKUP TOGGLE =================
local toggle = newBtn("AUTO PICKUP : OFF", 40, menu, Color3.fromRGB(200, 50, 50))
toggle.MouseButton1Click:Connect(function()
	enabled = not enabled
	toggle.BackgroundColor3 = enabled and Color3.fromRGB(76, 175, 80) or Color3.fromRGB(200, 50, 50)
	toggle.Text = enabled and "âœ“ AUTO PICKUP : ON" or "âœ— AUTO PICKUP : OFF"
end)

-- ================= FRONT ONLY TOGGLE =================
local frontBtn = newBtn("FRONT ONLY : ON", 82, menu, Color3.fromRGB(0, 150, 136))
frontBtn.MouseButton1Click:Connect(function()
	frontOnly = not frontOnly
	frontBtn.BackgroundColor3 = frontOnly and Color3.fromRGB(0, 150, 136) or Color3.fromRGB(80, 80, 85)
	frontBtn.Text = (frontOnly and "â†‘ FRONT ONLY : ON" or "â†” FRONT ONLY : OFF")
end)

-- Improved Pick All 360 with better object detection
local pickAllBtn = newBtn("ðŸŽ¯ NHáº¶T ALL (360Â°)", 124, menu, Color3.fromRGB(255, 152, 0))
pickAllBtn.MouseButton1Click:Connect(function()
	if not HRP then return end
	
	local picked = 0
	local processedObjects = {}
	
	-- Scan all interactive elements without distance limit
	for _, obj in ipairs(workspace:GetDescendants()) do
		if not obj:IsA("BasePart") or processedObjects[obj] then continue end
		
		-- Check distance
		if (HRP.Position - obj.Position).Magnitude > range then continue end
		
		-- Better blacklist checking with both all and solo
		if blacklistAll[obj.Name .. "_" .. obj.ClassName] or blacklistSolo[obj] then continue end
		
		-- Detect interactive elements
		local hasPrompt = false
		for _, v in ipairs(obj:GetDescendants()) do
			if v:IsA("ProximityPrompt") and v.Enabled then
				hasPrompt = true
				pcall(function()
					v.HoldDuration = 0
					fireproximityprompt(v)
					picked += 1
				end)
			end
		end
		
		processedObjects[obj] = true
	end
	
	print("[AUTO PICKUP] Nháº·t " .. picked .. " váº­t! (360Â°)")
end)

-- ================= SCAN BUTTON =================
local scanBtn = newBtn("ðŸ” QUÃ‰T DANH SÃCH", 166, menu, Color3.fromRGB(76, 175, 80))
scanBtn.MouseButton1Click:Connect(function()
	scanWindow.Visible = not scanWindow.Visible
	menu.Visible = false
	blacklistWindow.Visible = false
	
	-- Clear and refresh scan list
	scanList.CanvasSize = UDim2.new(0, 0, 0, 0)
	for _, child in ipairs(scanList:GetChildren()) do
		child:Destroy()
	end
	
	local yPos = 0
	local foundObjects = {}
	
	-- Enhanced scan to find all interactive objects including hidden ones
	for _, obj in ipairs(workspace:GetDescendants()) do
		if not obj:IsA("BasePart") then continue end
		if (HRP.Position - obj.Position).Magnitude > range then continue end
		
		-- Detect all types of interaction
		local hasPrompt = false
		for _, v in ipairs(obj:GetDescendants()) do
			if v:IsA("ProximityPrompt") then
				hasPrompt = true
				break
			end
		end
		
		if hasPrompt then
			table.insert(foundObjects, obj)
		end
	end
	
	-- Create UI entries with full object info
	for _, obj in ipairs(foundObjects) do
		local itemFrame = Instance.new("Frame", scanList)
		itemFrame.Size = UDim2.new(0, 420, 0, 65)
		itemFrame.Position = UDim2.new(0, 0, 0, yPos)
		itemFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
		itemFrame.BorderSizePixel = 0
		
		local itemCorner = Instance.new("UICorner", itemFrame)
		itemCorner.CornerRadius = UDim.new(0, 8)
		
		-- Item info label - show name and type clearly
		local itemLabel = Instance.new("TextLabel", itemFrame)
		itemLabel.Size = UDim2.new(0, 150, 0, 65)
		itemLabel.Position = UDim2.new(0, 10, 0, 0)
		itemLabel.Text = "ðŸ“¦ " .. obj.Name .. "\n(" .. obj.ClassName .. ")"
		itemLabel.Font = Enum.Font.Gotham
		itemLabel.TextSize = 11
		itemLabel.BackgroundTransparency = 1
		itemLabel.TextColor3 = Color3.new(1, 1, 1)
		itemLabel.TextXAlignment = Enum.TextXAlignment.Left
		itemLabel.TextWrapped = true
		
		-- Lock all similar objects (ðŸ”’)
		local lockBtn = Instance.new("TextButton", itemFrame)
		lockBtn.Size = UDim2.new(0, 38, 0, 38)
		lockBtn.Position = UDim2.new(0, 170, 0, 13)
		lockBtn.Text = "ðŸ”’"
		lockBtn.Font = Enum.Font.GothamBold
		lockBtn.TextSize = 16
		lockBtn.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
		lockBtn.TextColor3 = Color3.new(1, 1, 1)
		lockBtn.BorderSizePixel = 0
		
		local lockCorner = Instance.new("UICorner", lockBtn)
		lockCorner.CornerRadius = UDim.new(0, 6)
		
		lockBtn.MouseButton1Click:Connect(function()
			local key = obj.Name .. "_" .. obj.ClassName
			blacklistAll[key] = true
			lockBtn.BackgroundColor3 = Color3.fromRGB(150, 150, 150)
			lockBtn.Text = "âœ“"
			print("[LOCK ALL] KhÃ³a táº¥t cáº£ váº­t giá»‘ng: " .. obj.Name .. " (" .. obj.ClassName .. ")")
		end)
		
		-- Skip single object only (ðŸ› ï¸) - toggle lock/unlock
		local soloBtn = Instance.new("TextButton", itemFrame)
		soloBtn.Size = UDim2.new(0, 38, 0, 38)
		soloBtn.Position = UDim2.new(0, 218, 0, 13)
		soloBtn.Text = "ðŸ› ï¸"
		soloBtn.Font = Enum.Font.GothamBold
		soloBtn.TextSize = 16
		soloBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 150)
		soloBtn.TextColor3 = Color3.new(1, 1, 1)
		soloBtn.BorderSizePixel = 0
		
		local soloCorner = Instance.new("UICorner", soloBtn)
		soloCorner.CornerRadius = UDim.new(0, 6)
		
		soloBtn.MouseButton1Click:Connect(function()
			if blacklistSolo[obj] then
				blacklistSolo[obj] = nil
				soloBtn.BackgroundColor3 = Color3.fromRGB(100, 100, 150)
				soloBtn.Text = "ðŸ› ï¸"
				print("[SOLO UNLOCK] Má»Ÿ khÃ³a Ä‘Æ¡n: " .. obj.Name)
			else
				blacklistSolo[obj] = true
				soloBtn.BackgroundColor3 = Color3.fromRGB(150, 150, 150)
				soloBtn.Text = "âœ“"
				print("[SOLO LOCK] KhÃ³a Ä‘Æ¡n: " .. obj.Name)
			end
		end)
		
		-- Interact now (âœ…) - no distance limit
		local interactBtn = Instance.new("TextButton", itemFrame)
		interactBtn.Size = UDim2.new(0, 38, 0, 38)
		interactBtn.Position = UDim2.new(0, 266, 0, 13)
		interactBtn.Text = "âœ…"
		interactBtn.Font = Enum.Font.GothamBold
		interactBtn.TextSize = 16
		interactBtn.BackgroundColor3 = Color3.fromRGB(76, 175, 80)
		interactBtn.TextColor3 = Color3.new(1, 1, 1)
		interactBtn.BorderSizePixel = 0
		
		local interactCorner = Instance.new("UICorner", interactBtn)
		interactCorner.CornerRadius = UDim.new(0, 6)
		
		interactBtn.MouseButton1Click:Connect(function()
			for _, v in ipairs(obj:GetDescendants()) do
				if v:IsA("ProximityPrompt") and v.Enabled then
					pcall(function()
						v.HoldDuration = 0
						fireproximityprompt(v)
					end)
				end
			end
			interactBtn.BackgroundColor3 = Color3.fromRGB(100, 200, 100)
			interactBtn.Text = "âœ“"
			print("[INTERACT] TÆ°Æ¡ng tÃ¡c: " .. obj.Name)
			task.wait(0.3)
			interactBtn.BackgroundColor3 = Color3.fromRGB(76, 175, 80)
			interactBtn.Text = "âœ…"
		end)
		
		-- Highlight (ðŸ‘€)
		local highlightBtn = Instance.new("TextButton", itemFrame)
		highlightBtn.Size = UDim2.new(0, 38, 0, 38)
		highlightBtn.Position = UDim2.new(0, 314, 0, 13)
		highlightBtn.Text = "ðŸ‘€"
		highlightBtn.Font = Enum.Font.GothamBold
		highlightBtn.TextSize = 16
		highlightBtn.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
		highlightBtn.TextColor3 = Color3.new(1, 1, 1)
		highlightBtn.BorderSizePixel = 0
		
		local highlightCorner = Instance.new("UICorner", highlightBtn)
		highlightCorner.CornerRadius = UDim.new(0, 6)
		
		highlightBtn.MouseButton1Click:Connect(function()
			if obj:FindFirstChild("_Highlight") then
				obj:FindFirstChild("_Highlight"):Destroy()
				highlightBtn.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
				print("[HIGHLIGHT] Táº¯t: " .. obj.Name)
			else
				local h = Instance.new("Highlight", obj)
				h.Name = "_Highlight"
				h.FillColor = Color3.fromRGB(0, 255, 150)
				h.OutlineColor = Color3.fromRGB(0, 255, 150)
				h.Adornee = obj
				table.insert(highlightedObjects, h)
				highlightBtn.BackgroundColor3 = Color3.fromRGB(0, 255, 150)
				print("[HIGHLIGHT] Báº­t: " .. obj.Name)
			end
		end)
		
		-- Locate similar (ðŸ˜¶) - find all objects with same name
		local locateBtn = Instance.new("TextButton", itemFrame)
		locateBtn.Size = UDim2.new(0, 38, 0, 38)
		locateBtn.Position = UDim2.new(0, 362, 0, 13)
		locateBtn.Text = "ðŸ˜¶"
		locateBtn.Font = Enum.Font.GothamBold
		locateBtn.TextSize = 16
		locateBtn.BackgroundColor3 = Color3.fromRGB(156, 39, 176)
		locateBtn.TextColor3 = Color3.new(1, 1, 1)
		locateBtn.BorderSizePixel = 0
		
		local locateCorner = Instance.new("UICorner", locateBtn)
		locateCorner.CornerRadius = UDim.new(0, 6)
		
		locateBtn.MouseButton1Click:Connect(function()
			-- Clear previous
			for _, h in ipairs(locateHighlights) do
				if h and h.Parent then h:Destroy() end
			end
			locateHighlights = {}
			
			-- Find all similar
			local similarCount = 0
			for _, scanObj in ipairs(workspace:GetDescendants()) do
				if scanObj:IsA("BasePart") and scanObj.Name == obj.Name and scanObj.ClassName == obj.ClassName then
					local h = Instance.new("Highlight", scanObj)
					h.Name = "_LocateHighlight"
					h.FillColor = Color3.fromRGB(255, 100, 150)
					h.OutlineColor = Color3.fromRGB(255, 100, 150)
					h.Adornee = scanObj
					table.insert(locateHighlights, h)
					similarCount += 1
				end
			end
			print("[LOCATE] TÃ¬m tháº¥y " .. similarCount .. " váº­t giá»‘ng: " .. obj.Name)
		end)
		
		yPos += 75
	end
	
	scanList.CanvasSize = UDim2.new(0, 0, 0, yPos)
	print("[SCAN] TÃ¬m tháº¥y " .. #foundObjects .. " váº­t tÆ°Æ¡ng tÃ¡c!")
end)

-- View Blacklist button - now displays properly
local viewBlacklistBtn = newBtn("ðŸ“‹ DANH SÃCH KHÃ“A", 208, menu, Color3.fromRGB(200, 100, 50))
local function refreshBlacklist()
	-- Clear
	blacklistList.CanvasSize = UDim2.new(0, 0, 0, 0)
	for _, child in ipairs(blacklistList:GetChildren()) do
		child:Destroy()
	end
	
	local yPos = 0
	local count = 0
	
	-- Display lock all items
	for key, _ in pairs(blacklistAll) do
		local itemFrame = Instance.new("Frame", blacklistList)
		itemFrame.Size = UDim2.new(0, 420, 0, 55)
		itemFrame.Position = UDim2.new(0, 0, 0, yPos)
		itemFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 45)
		itemFrame.BorderSizePixel = 0
		
		local itemCorner = Instance.new("UICorner", itemFrame)
		itemCorner.CornerRadius = UDim.new(0, 8)
		
		local itemLabel = Instance.new("TextLabel", itemFrame)
		itemLabel.Size = UDim2.new(0, 200, 0, 55)
		itemLabel.Position = UDim2.new(0, 10, 0, 0)
		itemLabel.Text = "ðŸ”’ " .. key .. "\n(LOCK ALL)"
		itemLabel.Font = Enum.Font.Gotham
		itemLabel.TextSize = 11
		itemLabel.BackgroundTransparency = 1
		itemLabel.TextColor3 = Color3.new(1, 1, 1)
		itemLabel.TextXAlignment = Enum.TextXAlignment.Left
		itemLabel.TextWrapped = true
		
		-- Unlock button
		local unlockBtn = Instance.new("TextButton", itemFrame)
		unlockBtn.Size = UDim2.new(0, 38, 0, 38)
		unlockBtn.Position = UDim2.new(0, 220, 0, 8)
		unlockBtn.Text = "ðŸ”‘"
		unlockBtn.Font = Enum.Font.GothamBold
		unlockBtn.TextSize = 16
		unlockBtn.BackgroundColor3 = Color3.fromRGB(255, 193, 7)
		unlockBtn.TextColor3 = Color3.new(1, 1, 1)
		unlockBtn.BorderSizePixel = 0
		
		local unlockCorner = Instance.new("UICorner", unlockBtn)
		unlockCorner.CornerRadius = UDim.new(0, 6)
		
		unlockBtn.MouseButton1Click:Connect(function()
			blacklistAll[key] = nil
			print("[UNLOCK] Má»Ÿ khÃ³a: " .. key)
			refreshBlacklist()
		end)
		
		-- Locate similar
		local locateBtn = Instance.new("TextButton", itemFrame)
		locateBtn.Size = UDim2.new(0, 38, 0, 38)
		locateBtn.Position = UDim2.new(0, 268, 0, 8)
		locateBtn.Text = "ðŸ˜¶"
		locateBtn.Font = Enum.Font.GothamBold
		locateBtn.TextSize = 16
		locateBtn.BackgroundColor3 = Color3.fromRGB(156, 39, 176)
		locateBtn.TextColor3 = Color3.new(1, 1, 1)
		locateBtn.BorderSizePixel = 0
		
		local locateCorner = Instance.new("UICorner", locateBtn)
		locateCorner.CornerRadius = UDim.new(0, 6)
		
		locateBtn.MouseButton1Click:Connect(function()
			for _, h in ipairs(locateHighlights) do
				if h and h.Parent then h:Destroy() end
			end
			locateHighlights = {}
			
			local namePart = string.match(key, "(.+)_[^_]+$")
			local similarCount = 0
			for _, obj in ipairs(workspace:GetDescendants()) do
				if obj:IsA("BasePart") and obj.Name == namePart then
					local h = Instance.new("Highlight", obj)
					h.FillColor = Color3.fromRGB(255, 100, 150)
					h.OutlineColor = Color3.fromRGB(255, 100, 150)
					table.insert(locateHighlights, h)
					similarCount += 1
				end
			end
			print("[LOCATE] TÃ¬m tháº¥y " .. similarCount .. " váº­t giá»‘ng")
		end)
		
		yPos += 65
		count += 1
	end
	
	if count == 0 then
		local emptyLabel = Instance.new("TextLabel", blacklistList)
		emptyLabel.Size = UDim2.new(0, 420, 0, 50)
		emptyLabel.Position = UDim2.new(0, 0, 0, 20)
		emptyLabel.Text = "âœ… KhÃ´ng cÃ³ váº­t bá»‹ khÃ³a"
		emptyLabel.Font = Enum.Font.Gotham
		emptyLabel.TextSize = 12
		emptyLabel.BackgroundTransparency = 1
		emptyLabel.TextColor3 = Color3.fromRGB(150, 150, 150)
	end
	
	blacklistList.CanvasSize = UDim2.new(0, 0, 0, math.max(yPos, 60))
end

viewBlacklistBtn.MouseButton1Click:Connect(function()
	blacklistWindow.Visible = not blacklistWindow.Visible
	menu.Visible = false
	scanWindow.Visible = false
	refreshBlacklist()
end)

-- ================= RANGE CONTROL =================
newLabel("PHáº M VI", 250, menu)

local rMinus = newBtn("-", 274, menu, Color3.fromRGB(200, 50, 50))
local rPlus = newBtn("+", 318, menu, Color3.fromRGB(76, 175, 80))
local rBox = Instance.new("TextBox", menu)
rBox.Size = UDim2.new(0, 250, 0, 28)
rBox.Position = UDim2.new(0, 15, 0, 296)
rBox.Text = tostring(range)
rBox.Font = Enum.Font.Gotham
rBox.TextSize = 12
rBox.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
rBox.TextColor3 = Color3.new(1, 1, 1)
rBox.BorderSizePixel = 0

local rBoxCorner = Instance.new("UICorner", rBox)
rBoxCorner.CornerRadius = UDim.new(0, 8)

rMinus.MouseButton1Click:Connect(function()
	range = math.max(3, range - 1)
	rBox.Text = tostring(range)
end)

rPlus.MouseButton1Click:Connect(function()
	range = range + 1
	rBox.Text = tostring(range)
end)

rBox.FocusLost:Connect(function()
	range = tonumber(rBox.Text) or range
	rBox.Text = tostring(range)
end)

-- ================= SPEED CONTROL =================
newLabel("Tá»C Äá»˜ NHáº¶T", 360, menu)

local dMinus = newBtn("-", 384, menu, Color3.fromRGB(200, 50, 50))
local dPlus = newBtn("+", 428, menu, Color3.fromRGB(76, 175, 80))
local dBox = Instance.new("TextBox", menu)
dBox.Size = UDim2.new(0, 250, 0, 28)
dBox.Position = UDim2.new(0, 15, 0, 406)
dBox.Text = string.format("%.2f", delayTime)
dBox.Font = Enum.Font.Gotham
dBox.TextSize = 12
dBox.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
dBox.TextColor3 = Color3.new(1, 1, 1)
dBox.BorderSizePixel = 0

local dBoxCorner = Instance.new("UICorner", dBox)
dBoxCorner.CornerRadius = UDim.new(0, 8)

dMinus.MouseButton1Click:Connect(function()
	delayTime = math.max(0.05, delayTime - 0.05)
	dBox.Text = string.format("%.2f", delayTime)
end)

dPlus.MouseButton1Click:Connect(function()
	delayTime = delayTime + 0.05
	dBox.Text = string.format("%.2f", delayTime)
end)

dBox.FocusLost:Connect(function()
	delayTime = tonumber(dBox.Text) or delayTime
	dBox.Text = string.format("%.2f", delayTime)
end)

-- ================= FIX BUTTON =================
local fixBtn = newBtn("ðŸ”§ FIX REAL", 470, menu, Color3.fromRGB(255, 152, 0))

-- ================= CORE FUNCTIONS =================

local function inFront(obj)
	if not frontOnly then return true end
	local dir = (obj.Position - HRP.Position).Unit
	return HRP.CFrame.LookVector:Dot(dir) > 0
end

local function safeInteract(model)
	for _, v in ipairs(model:GetDescendants()) do
		if v:IsA("ProximityPrompt") and v.Enabled then
			pcall(function()
				v.HoldDuration = 0
				fireproximityprompt(v)
			end)
		end
	end
end

local function fixHitbox()
	if not Char then return end
	for _, v in ipairs(Char:GetDescendants()) do
		if v:IsA("BasePart") then
			pcall(function()
				v.Massless = false
				v.CustomPhysicalProperties = PhysicalProperties.new(1, 0.3, 0.5)
			end)
		end
	end
end

local function fixPrompt()
	for _, v in ipairs(workspace:GetDescendants()) do
		if v:IsA("ProximityPrompt") then
			pcall(function()
				v.Enabled = true
				if v.HoldDuration > 0 then
					v.HoldDuration = 0
				end
			end)
		end
	end
end

local function fixRay()
	pcall(function()
		Cam:Reset()
	end)
end

fixBtn.MouseButton1Click:Connect(function()
	fixHitbox()
	fixPrompt()
	fixRay()
	print("[FIX] ÄÃ£ phá»¥c há»“i há»‡ thá»‘ng!")
end)

-- ================= KEYBOARD SHORTCUT =================
UserInputService.InputBegan:Connect(function(input, gameProcessed)
	if gameProcessed then return end
	if input.KeyCode == Enum.KeyCode.F12 then
		menu.Visible = not menu.Visible
		scanWindow.Visible = false
		blacklistWindow.Visible = false
	end
end)

-- ================= MAIN LOOP =================
task.spawn(function()
	while task.wait(delayTime) do
		if not enabled or not HRP then continue end

		for _, obj in ipairs(workspace:GetDescendants()) do
			if not obj:IsA("BasePart") then continue end
			if (HRP.Position - obj.Position).Magnitude > range then continue end
			if not inFront(obj) then continue end
			
			-- Fixed blacklist checking with both all and solo
			local key = obj.Name .. "_" .. obj.ClassName
			if blacklistAll[key] or blacklistSolo[obj] then continue end

			safeInteract(obj)
		end
	end
end)

print("[AUTO PICKUP PREMIUM] Script Ä‘Ã£ táº£i! Nháº¥n F12 Ä‘á»ƒ má»Ÿ menu.")
